# mySociety Data Portal repo

A lightweight, backend-free open data portal, powered by Jekyll

View at https://data.mysociety.org

# Adding data

## Updating from datapackages repos

* Packages can be automatically imported from the new data publishing approach. Add the new page to the `_data/datapackages.yaml` file. The github action should sync relevant content from that. The categories are taken from the 'keywords' in the original datapackage.yaml - so either add those to the source, or add manually afterward. 

## Add data manually

Add a new file in `_datasets` following the examples there. 

## Local Development

There is a docker config that will work locally or on codespaces. 

Within this `script/server` will run the local debug server.

This will then start the rendering process and serve on http://127.0.0.1:4000

### Docker Step-by-step

1. docker-compose run app /bin/bash
2. container> Get the IP address of the container via ```ip a```
3. container> ./scripts/server (wait for it to Server Running at 0.0.0.0:4000)
4. browser> Go to http://172.20.0.2:4000/ where 172.20.0.2 is replaced by the IP from step 2.

## Theme

Jkan runs on Jekyll.

Local adaptions to mySociety theme are in sass folder - both that and 'theme/sass' are equally accessible to compiler - so no need for relative paths. 

Key template is templates/default.html - this then brings in various mysoc_ includes. 

Don't forget to `git submodule update --init --recursive` to pull down the mySociety styles

If running locally, categories are generated by `ruby script/generate_categories.rb` - this is handled as part of the build action otherwise. 